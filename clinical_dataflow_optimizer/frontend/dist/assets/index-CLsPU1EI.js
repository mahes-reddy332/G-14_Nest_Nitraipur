const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-Hi3_WLRf.js","assets/vendor-query-3cLbHxHt.js","assets/vendor-antd-CMNZCwNL.js","assets/relativeTime-myFe_gQo.js","assets/vendor-react-BULyYbn8.js","assets/vendor-state-hAMrnFl_.js","assets/Studies-D-RyZlaO.js","assets/Patients-BWasYxDT.js","assets/Sites-DBFOGLwY.js","assets/Alerts-D7MC4OK3.js","assets/Agents-CCMaGuDx.js","assets/Conversational-CPKXsNyv.js","assets/Reports-5gnuz7RH.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{j as s,b as a,r,u as n,Q as i,R as o,d as c}from"./vendor-query-3cLbHxHt.js";import{r as l,L as d,R as u,M as y,a as p,b as _,c as m,d as g,e as h,f,g as x,h as v,S as w,i as j,T as b,B as S,j as k,k as R,l as A,D as C,A as E,m as I,n as q,o as D,p as T,q as L,s as O,t as N,u as P,v as $,w as z,x as U,y as Q,_ as B,z as M,C as F}from"./vendor-antd-CMNZCwNL.js";import{u as H,a as W,B as V,R as G,b as K,N as J}from"./vendor-react-BULyYbn8.js";import{c as X}from"./vendor-state-hAMrnFl_.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Y={},Z=l;Y.createRoot=Z.createRoot,Y.hydrateRoot=Z.hydrateRoot;const{Sider:ee}=d,te=[{key:"/dashboard",icon:s.jsx(p,{}),label:"Dashboard"},{key:"/studies",icon:s.jsx(_,{}),label:"Studies"},{key:"/patients",icon:s.jsx(m,{}),label:"Patients"},{key:"/sites",icon:s.jsx(g,{}),label:"Sites"},{key:"/alerts",icon:s.jsx(h,{}),label:"Alerts"},{key:"/agents",icon:s.jsx(f,{}),label:"AI Agents"},{key:"/conversational",icon:s.jsx(x,{}),label:"Chatbot"},{key:"/reports",icon:s.jsx(v,{}),label:"Reports"}];function se({collapsed:e,onCollapse:t}){const a=H(),r=W();return s.jsxs(ee,{collapsible:!0,collapsed:e,onCollapse:t,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:[s.jsxs("div",{style:{height:64,margin:16,display:"flex",alignItems:"center",justifyContent:e?"center":"flex-start"},children:[s.jsx(u,{style:{fontSize:24,color:"#fff"}}),!e&&s.jsx("span",{style:{color:"#fff",fontSize:16,fontWeight:"bold",marginLeft:12},children:"Clinical DM"})]}),s.jsx(y,{theme:"dark",mode:"inline",selectedKeys:[r.pathname],items:te,onClick:({key:e})=>a(e)})]})}const ae=X()((e,t)=>({isConnected:!1,setConnected:t=>e({isConnected:t}),dashboardSummary:null,setDashboardSummary:t=>e({dashboardSummary:t}),recentUpdates:[],addUpdate:t=>e(e=>({recentUpdates:[t,...e.recentUpdates].slice(0,100)})),clearUpdates:()=>e({recentUpdates:[]}),activeAlerts:[],addAlert:t=>e(e=>({activeAlerts:[t,...e.activeAlerts],unreadNotifications:e.unreadNotifications+1})),updateAlert:(t,s)=>e(e=>({activeAlerts:e.activeAlerts.map(e=>e.alert_id===t?{...e,...s}:e)})),removeAlert:t=>e(e=>({activeAlerts:e.activeAlerts.filter(e=>e.alert_id!==t)})),setAlerts:t=>e({activeAlerts:t}),unreadNotifications:0,incrementNotifications:()=>e(e=>({unreadNotifications:e.unreadNotifications+1})),resetNotifications:()=>e({unreadNotifications:0}),selectedStudyId:null,setSelectedStudyId:t=>e({selectedStudyId:t}),errors:[],addError:t=>e(e=>({errors:[t,...e.errors].slice(0,50)})),clearError:t=>e(e=>({errors:e.errors.filter((e,s)=>s!==t)})),clearAllErrors:()=>e({errors:[]}),loadingStates:{},setLoading:(t,s,a)=>e(e=>({loadingStates:{...e.loadingStates,[t]:{isLoading:s,operation:t,progress:a}}})),getLoading:e=>t().loadingStates[e],retryQueue:[],addToRetryQueue:(t,s,a=3)=>e(e=>({retryQueue:[...e.retryQueue,{id:t,operation:s,retries:0,maxRetries:a}]})),removeFromRetryQueue:t=>e(e=>({retryQueue:e.retryQueue.filter(e=>e.id!==t)})),processRetryQueue:()=>e(e=>{const s=[...e.retryQueue];return s.forEach(async(e,a)=>{if(e.retries<e.maxRetries)try{await e.operation(),s.splice(a,1)}catch(r){e.retries+=1,setTimeout(()=>{t().processRetryQueue()},1e3*Math.pow(2,e.retries))}else t().addError({message:`Operation ${e.id} failed after ${e.maxRetries} retries`,code:"MAX_RETRIES_EXCEEDED",timestamp:new Date,context:e.id}),s.splice(a,1)}),{retryQueue:s}})})),re=e=>{if(!e.response)return!0;const t=e.response.status;return t>=500||408===t||429===t};const ne="/api",ie=a.create({baseURL:ne,headers:{"Content-Type":"application/json"}});async function oe(e,t,s){const r=await async function(e,t={},s){const{maxRetries:r=3,baseDelay:n=1e3,maxDelay:i=1e4,retryCondition:o=re,onRetry:c}=t;let l;for(let u=0;u<=r;u++)try{null==s||s.onLoadingChange;const t=await a(e);return null==s||s.onLoadingChange,t}catch(d){if(l=d,u===r||!o(d))throw d;const e=Math.min(n*Math.pow(2,u),i),t=e+.1*Math.random()*e;c&&c(u+1,d),await new Promise(e=>setTimeout(e,t))}throw l}({...e,baseURL:ne},s);return r.data}const ce={getAll:async()=>{const e=await oe({method:"GET",url:"/studies/"});return(Array.isArray(e)?e:[]).map(e=>({study_id:e.study_id,name:e.study_name||e.name||e.study_id,phase:e.phase||"Unknown",status:e.status||"unknown",therapeutic_area:e.therapeutic_area||"Unknown",total_patients:e.total_patients??0,total_sites:e.total_sites??0,clean_patients:e.clean_patients??0,dirty_patients:e.dirty_patients??0,dqi_score:e.dqi_score??e.overall_dqi??0,last_updated:e.last_updated||(new Date).toISOString()})).sort((e,t)=>{const s=Number.parseInt(e.study_id.replace(/\D/g,""),10),a=Number.parseInt(t.study_id.replace(/\D/g,""),10);return Number.isFinite(s)&&Number.isFinite(a)?s-a:e.study_id.localeCompare(t.study_id)})},getById:async e=>{const t=await oe({method:"GET",url:`/studies/${e}`});return{study_id:t.study_id,name:t.name||t.study_id,phase:t.phase||"Unknown",status:t.status||"active",therapeutic_area:t.therapeutic_area||"Unknown",total_patients:t.total_patients||0,total_sites:t.total_sites||0,clean_patients:t.clean_patients||0,dirty_patients:t.dirty_patients||0,dqi_score:t.overall_dqi||t.dqi_score||0,last_updated:t.last_updated||(new Date).toISOString()}},getMetrics:async e=>{const{data:t}=await ie.get(`/studies/${e}/metrics`);return t},getRegions:async e=>{const{data:t}=await ie.get(`/studies/${e}/regions`);return t},getTrends:async(e,t=30)=>{const{data:s}=await ie.get(`/studies/${e}/trends`,{params:{days:t}});return s},getRiskAssessment:async e=>{const{data:t}=await ie.get(`/studies/${e}/risk-assessment`);return t},getHeatmap:async(e,t="dqi")=>{const{data:s}=await ie.get(`/studies/${e}/heatmap`,{params:{metric:t}});return s},getSourceFiles:async e=>{const{data:t}=await ie.get(`/studies/${e}/source-files`);return t},getSites:async e=>{try{const{data:t}=await ie.get(`/studies/${e}/sites`);return(Array.isArray(t)?t:[]).map(e=>({site_id:e.site_id,name:e.name||e.site_name||e.site_id,country:e.country||"Unknown",region:e.region||"Unknown",status:e.status||"active",patient_count:e.patient_count||e.total_patients||0,dqi_score:e.dqi_score||e.overall_dqi||0,query_resolution_time:e.avg_query_resolution_days||0,last_updated:e.last_updated||(new Date).toISOString()}))}catch(t){return de.getAll({study_id:e})}}},le={getAll:async e=>{const{data:t}=await ie.get("/patients/",{params:e});return(t.patients||t).map(e=>{var t,s,a,r;return{patient_id:e.patient_id,study_id:e.study_id,site_id:e.site_id,enrollment_date:e.enrollment_date||"",status:(null==(t=e.clean_status)?void 0:t.status)||"unknown",is_clean:(null==(s=e.clean_status)?void 0:s.is_clean)??!1,cleanliness_score:(null==(a=e.clean_status)?void 0:a.cleanliness_score)??0,visit_count:e.total_visits||e.completed_visits||0,query_count:(null==(r=e.clean_status)?void 0:r.open_queries)??0,last_updated:e.last_visit_date||""}})},getById:async e=>{const{data:t}=await ie.get(`/patients/${e}`);return t},getCleanStatus:async e=>{const{data:t}=await ie.get(`/patients/${e}/clean-status`);return{patient_id:e,is_clean:t.is_clean??!1,cleanliness_score:t.cleanliness_score??0,blocking_factors:(t.blocking_factors||[]).map(e=>"string"==typeof e?{factor_type:e,description:e,severity:"medium",domain:"general",resolution_action:"Review required"}:e),last_checked:t.last_calculated||(new Date).toISOString(),lock_readiness:t.is_clean?"Ready":"Not Ready"}},getDirtyPatients:async e=>{const{data:t}=await ie.get("/patients/dirty",{params:{study_id:e}});return(Array.isArray(t)?t:[]).map(e=>{var t,s,a;return{patient_id:e.patient_id,study_id:e.study_id,site_id:e.site_id,enrollment_date:e.enrollment_date||"",status:(null==(t=e.clean_status)?void 0:t.status)||"dirty",is_clean:!1,cleanliness_score:(null==(s=e.clean_status)?void 0:s.cleanliness_score)??0,visit_count:e.total_visits||0,query_count:(null==(a=e.clean_status)?void 0:a.open_queries)??0,last_updated:e.last_visit_date||""}})},getAtRiskPatients:async e=>{const{data:t}=await ie.get("/patients/at-risk",{params:{study_id:e}});return(Array.isArray(t)?t:[]).map(e=>{var t,s;return{patient_id:e.patient_id,study_id:e.study_id,site_id:e.site_id,enrollment_date:e.enrollment_date||"",status:"at-risk",is_clean:!1,cleanliness_score:(null==(t=e.clean_status)?void 0:t.cleanliness_score)??0,visit_count:e.total_visits||0,query_count:(null==(s=e.clean_status)?void 0:s.open_queries)??0,last_updated:e.last_visit_date||""}})},getStatusChanges:async(e=24)=>{const{data:t}=await ie.get("/patients/status-changes",{params:{hours:e}});return t},getBlockingFactors:async e=>{const{data:t}=await ie.get("/patients/blocking-factors",{params:{study_id:e}});return t},getLockReadiness:async e=>{const{data:t}=await ie.get("/patients/lock-readiness",{params:{study_id:e}});return t}},de={getAll:async e=>{const{data:t}=await ie.get("/sites/",{params:e});return(Array.isArray(t)?t:[]).map(e=>({site_id:e.site_id,name:e.name||e.site_name||e.site_id,country:e.country||"Unknown",region:e.region||"Unknown",status:e.status||"active",patient_count:e.patient_count||e.total_patients||0,dqi_score:e.dqi_score||e.overall_dqi||0,query_resolution_time:e.avg_query_resolution_days||e.query_resolution_time||0,last_updated:e.last_updated||(new Date).toISOString()}))},getById:async e=>{const{data:t}=await ie.get(`/sites/${e}`);return{site_id:t.site_id,name:t.name||t.site_name||t.site_id,country:t.country||"Unknown",region:t.region||"Unknown",status:t.status||"active",patient_count:t.patient_count||t.total_patients||0,dqi_score:t.dqi_score||t.overall_dqi||0,query_resolution_time:t.avg_query_resolution_days||t.query_resolution_time||0,last_updated:t.last_updated||(new Date).toISOString()}},getPerformance:async e=>{const{data:t}=await ie.get(`/sites/${e}/performance`);return t},getHighRisk:async e=>{const{data:t}=await ie.get("/sites/high-risk",{params:{study_id:e}});return t},getSlowResolution:async(e,t=7)=>{const{data:s}=await ie.get("/sites/slow-resolution",{params:{study_id:e,threshold:t}});return s},getComparison:async e=>{const{data:t}=await ie.get("/sites/comparison",{params:{study_id:e}});return t},getCraActivity:async e=>{const{data:t}=await ie.get("/sites/cra-activity",{params:{study_id:e}});return t}},ue={getKPITiles:async e=>{const{data:t}=await ie.get("/metrics/kpi-tiles",{params:{study_id:e}});return Array.isArray(t)?t:[]},getDQI:async e=>{const{data:t}=await ie.get("/metrics/dqi",{params:{study_id:e}});return{overall_dqi:t.overall_dqi??0,completeness:t.completeness??0,accuracy:t.accuracy??0,consistency:t.consistency??0,timeliness:t.timeliness??0,trend:t.trend??[],by_domain:{visits:t.completeness??0,queries:t.consistency??0,coding:t.accuracy??0,safety:t.conformity??t.timeliness??0,...t.by_domain??{}}}},getCleanliness:async e=>{const{data:t}=await ie.get("/metrics/cleanliness",{params:{study_id:e}}),s=t.clean_patients??t.clean_count??0,a=t.dirty_patients??t.dirty_count??0,r=t.pending_patients??t.at_risk_count??0;return{clean_count:s,dirty_count:a,at_risk_count:r,cleanliness_rate:s+a+r>0?t.overall_rate??t.cleanliness_rate??0:0,trend:t.trend??[],by_study:t.by_category??t.by_study??{}}},getQueries:async e=>{const{data:t}=await ie.get("/metrics/queries",{params:{study_id:e}});return{total_queries:t.total_queries??0,open_queries:t.open_queries??0,closed_queries:t.closed_queries??0,resolution_rate:t.resolution_rate??0,avg_resolution_time:t.avg_resolution_time_days??t.avg_resolution_time??0,aging_distribution:t.aging_distribution??{}}},getSAEs:async e=>{const{data:t}=await ie.get("/metrics/saes",{params:{study_id:e}});return{total_saes:t.total_saes??0,reconciled:t.reconciled??0,pending:t.pending??0,overdue:t.overdue??0,reconciliation_rate:t.reconciliation_rate??0,avg_reconciliation_days:t.avg_reconciliation_days??0,by_seriousness:t.by_seriousness??{}}},getCoding:async e=>{const{data:t}=await ie.get("/metrics/coding",{params:{study_id:e}});return{total_terms:t.total_terms??0,coded:t.coded??0,uncoded:t.uncoded??0,completion_rate:t.completion_rate??0,meddra_status:t.meddra_status??{},whodrug_status:t.whodrug_status??{},uncoded_breakdown:t.uncoded_breakdown??[]}},getVelocity:async(e,t=7)=>{const{data:s}=await ie.get("/metrics/velocity",{params:{study_id:e,days:t}}),a=s.trend||[],r=Array.isArray(a)&&a.length>0&&"object"==typeof a[0]?a:a.map((e,t)=>({date:new Date(Date.now()-864e5*(a.length-1-t)).toISOString().split("T")[0],queries:Math.round(e),resolutions:0}));return{queries_per_day:s.query_resolution_velocity??s.queries_per_day??0,resolutions_per_day:s.resolutions_per_day??0,data_entries_per_day:s.form_completion_velocity??s.data_entries_per_day??0,trend:r}},getHeatmap:async(e,t="dqi")=>{const{data:s}=await ie.get("/metrics/heatmap",{params:{study_id:e,metric:t}});return s},getAnomalies:async e=>{const{data:t}=await ie.get("/metrics/anomalies",{params:{study_id:e}});return t},getDashboardSummary:async e=>{try{const{data:t}=await ie.get("/dashboard/summary",{params:{study_id:e}});return t}catch(t){const[s,a]=await Promise.all([ue.getCleanliness(e).catch(()=>null),ue.getQueries(e).catch(()=>null)]);return{total_studies:0,total_patients:((null==s?void 0:s.clean_count)||0)+((null==s?void 0:s.dirty_count)||0)+((null==s?void 0:s.at_risk_count)||0),total_sites:0,clean_patients:(null==s?void 0:s.clean_count)||0,dirty_patients:(null==s?void 0:s.dirty_count)||0,overall_dqi:0,open_queries:(null==a?void 0:a.open_queries)||0,pending_saes:0,uncoded_terms:0,last_updated:(new Date).toISOString(),cleanliness_rate:(null==s?void 0:s.cleanliness_rate)||0}}},getDQIBreakdown:async e=>{try{const t=await ue.getDQI(e);return{overall:t.overall_dqi||0,completeness:t.completeness||0,accuracy:t.accuracy||0,consistency:t.consistency||0,timeliness:t.timeliness||0,trend:t.trend||[]}}catch(t){return{overall:85,completeness:97.9,accuracy:100,consistency:70,timeliness:75,trend:[82,84,85,84,86,87,85]}}}},ye={getAll:async e=>{const{data:t}=await ie.get("/alerts/",{params:e});return Array.isArray(t)?t:[]},getSummary:async()=>{const{data:e}=await ie.get("/alerts/summary");return e},getCritical:async()=>{const{data:e}=await ie.get("/alerts/critical");return e},getRecent:async(e=24)=>{const{data:t}=await ie.get("/alerts/recent",{params:{hours:e}});return t},acknowledge:async(e,t,s)=>{const{data:a}=await ie.post(`/alerts/${e}/acknowledge`,{acknowledged_by:t,note:s||""});return a},resolve:async(e,t,s,a)=>{const{data:r}=await ie.post(`/alerts/${e}/resolve`,{resolved_by:t,resolution_note:s||"",actions_taken:a||[]});return r},dismiss:async(e,t,s)=>{const{data:a}=await ie.post(`/alerts/${e}/dismiss`,null,{params:{dismissed_by:t,reason:s}});return a},getHistory:async(e=30,t)=>{const{data:s}=await ie.get("/alerts/history",{params:{days:e,category:t}});return s},getTrends:async(e=7)=>{const{data:t}=await ie.get("/alerts/trends",{params:{days:e}});return t}},pe={list:async()=>{const{data:e}=await ie.get("/reports/");return Array.isArray(e)?e:[]},getById:async e=>{const{data:t}=await ie.get(`/reports/${e}`);return t}},_e={getStatus:async()=>{const{data:e}=await ie.get("/agents/status");if(Array.isArray(e)){const t={};return e.forEach(e=>{t[e.agent_type||e.name]=e}),t}return e||{}},getInsights:async e=>{const{data:t}=await ie.get("/agents/insights",{params:e});return Array.isArray(t)?t:[]},getRecommendations:async e=>{const{data:t}=await ie.get("/agents/recommendations",{params:e});return t},getExplainability:async e=>{const{data:t}=await ie.get(`/agents/explain/${e}`);return t},getReconciliationDiscrepancies:async(e,t)=>{const{data:s}=await ie.get("/agents/reconciliation/discrepancies",{params:{study_id:e,severity:t}});return s},getCodingIssues:async(e,t)=>{const{data:s}=await ie.get("/agents/coding/issues",{params:{study_id:e,status:t}});return s}},me=`${`${"https:"===window.location.protocol?"wss":"ws"}://${window.location.host}`.replace(/\/$/,"")}/ws/dashboard`,ge=1e3;function he(){const e=r.useRef(null),t=r.useRef(null),s=r.useRef(null),a=r.useRef(null),n=r.useRef(null),i=r.useRef(ge),o=r.useRef(null),c=r.useRef(!1),[l,d]=r.useState("disconnected"),[u,y]=r.useState(!1),{setConnected:p,addUpdate:_,addAlert:m}=ae(),g=r.useCallback(async()=>{try{const e=await fetch("/api/ready");if(e.ok){return(await e.json()).is_ready}return e.status,!1}catch{return!1}},[]),h=r.useCallback(async()=>(null===o.current&&(o.current=Date.now()),d("waiting_for_backend"),new Promise(e=>{const t=async()=>{if(Date.now()-(o.current||Date.now())>6e4)return o.current=null,n.current&&(clearInterval(n.current),n.current=null),void e(!1);await g()&&(y(!0),o.current=null,n.current&&(clearInterval(n.current),n.current=null),e(!0))};t(),n.current||(n.current=setInterval(t,2e3))})),[g]),f=r.useCallback(()=>{t.current&&(clearTimeout(t.current),t.current=null),s.current&&(clearInterval(s.current),s.current=null),a.current&&(clearTimeout(a.current),a.current=null),n.current&&(clearInterval(n.current),n.current=null)},[]),x=r.useCallback(()=>{s.current&&clearInterval(s.current),s.current=setInterval(()=>{var t;if((null==(t=e.current)?void 0:t.readyState)===WebSocket.OPEN)try{e.current.send(JSON.stringify({type:"ping"})),a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{var t;null==(t=e.current)||t.close()},1e4)}catch(s){}},25e3)},[]),v=r.useCallback(e=>{t.current&&clearTimeout(t.current);const s=e??Math.min(i.current,3e4);t.current=setTimeout(()=>{i.current=Math.min(1.5*i.current,3e4),w()},s)},[]),w=r.useCallback(async()=>{var t,s;if(!c.current&&(null==(t=e.current)?void 0:t.readyState)!==WebSocket.OPEN&&(null==(s=e.current)?void 0:s.readyState)!==WebSocket.CONNECTING){c.current=!0;try{if(!u){if(!(await h()))return c.current=!1,void v(2e3)}d("connecting"),e.current=new WebSocket(me),e.current.onopen=()=>{d("connected"),p(!0),c.current=!1,i.current=ge,x()},e.current.onmessage=e=>{try{const t=JSON.parse(e.data);if("pong"===t.type||"heartbeat"===t.type)return void(a.current&&(clearTimeout(a.current),a.current=null));const s=t;_(s),"new_alert"===s.type&&s.data&&m(s.data)}catch(t){}},e.current.onclose=e=>{d("disconnected"),p(!1),c.current=!1,f(),1e3!==e.code&&v()},e.current.onerror=()=>{c.current=!1}}catch(r){d("disconnected"),p(!1),c.current=!1,v()}}},[p,_,m,u,h,x,v,f]),j=r.useCallback(()=>{w()},[w]),b=r.useCallback(()=>{f(),c.current=!1,e.current&&(e.current.close(1e3,"User disconnect"),e.current=null),d("disconnected"),p(!1),y(!1),o.current=null,i.current=ge},[p,f]),S=r.useCallback(t=>{var s;(null==(s=e.current)?void 0:s.readyState)===WebSocket.OPEN&&e.current.send(JSON.stringify(t))},[]),k=r.useCallback(()=>{b(),y(!1),setTimeout(()=>j(),100)},[b,j]);return r.useEffect(()=>{j();const t=()=>{var t;"visible"===document.visibilityState&&(null==(t=e.current)?void 0:t.readyState)!==WebSocket.OPEN&&j()};document.addEventListener("visibilitychange",t);const s=()=>{y(!1),j()};return window.addEventListener("online",s),()=>{b(),document.removeEventListener("visibilitychange",t),window.removeEventListener("online",s)}},[j,b]),{connect:j,disconnect:b,send:S,forceReconnect:k,connectionState:l,backendReady:u}}const{Header:fe}=d;function xe({connectionState:e,isConnected:t}){const a=t?"connected":e,r={connected:{color:"#52c41a",icon:s.jsx(T,{}),text:"Connected",tooltip:"Real-time connection active"},connecting:{color:"#1890ff",icon:s.jsx(D,{spin:!0}),text:"Connecting...",tooltip:"Establishing connection to server"},waiting_for_backend:{color:"#faad14",icon:s.jsx(q,{}),text:"Starting...",tooltip:"Waiting for backend services to initialize"},disconnected:{color:"#ff4d4f",icon:s.jsx(I,{}),text:"Disconnected",tooltip:"Connection lost. Reconnecting automatically..."}}[a];return s.jsx(b,{title:r.tooltip,children:s.jsxs("div",{className:"realtime-indicator",style:{display:"flex",alignItems:"center",gap:6},children:["connected"===a&&s.jsx("div",{className:"realtime-dot"}),s.jsxs("span",{style:{color:r.color,display:"flex",alignItems:"center",gap:4},children:[r.icon," ",r.text]})]})})}function ve(){var e;const{isConnected:t,selectedStudyId:a,setSelectedStudyId:r,unreadNotifications:i,resetNotifications:o}=ae(),{connectionState:c,forceReconnect:l}=he(),{data:d=[]}=n({queryKey:["studies"],queryFn:ce.getAll}),{data:u}=n({queryKey:["alertSummary"],queryFn:ye.getSummary,refetchInterval:3e4}),y=[{value:"",label:"All Studies"},...d.map(e=>({value:e.study_id,label:e.name||e.study_id}))];return s.jsxs(fe,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:[s.jsxs(w,{size:"large",children:[s.jsx(j,{style:{width:200},placeholder:"Select Study",value:a||"",onChange:e=>r(e||null),options:y}),s.jsx(xe,{connectionState:c,isConnected:t})]}),s.jsxs(w,{size:"middle",children:[s.jsx(b,{title:"Force reconnect to server",children:s.jsx(S,{type:"text",icon:s.jsx(k,{}),onClick:l,children:"Reconnect"})}),s.jsx(R,{count:(null==(e=null==u?void 0:u.by_severity)?void 0:e.critical)||0,style:{backgroundColor:"#ff4d4f"},children:s.jsx(R,{count:i,offset:[0,0],children:s.jsx(S,{type:"text",icon:s.jsx(A,{style:{fontSize:20}}),onClick:o})})}),s.jsx(C,{menu:{items:[{key:"profile",label:"Profile"},{key:"settings",label:"Settings"},{type:"divider"},{key:"logout",label:"Logout"}]},children:s.jsx(E,{icon:s.jsx(m,{}),style:{cursor:"pointer"}})})]})]})}const{Title:we,Text:je,Paragraph:be}=L;class Se extends r.Component{constructor(e){super(e),t(this,"reportError",async(e,t)=>{}),t(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})}),t(this,"handleGoHome",()=>{window.location.href="/"}),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t),this.reportError(e,t)}render(){var e;return this.state.hasError?this.props.fallback?this.props.fallback:s.jsx("div",{style:{minHeight:"400px",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:s.jsx(O,{status:"error",icon:s.jsx($,{style:{color:"#ff4d4f"}}),title:s.jsx(we,{level:3,style:{color:"#ff4d4f",marginBottom:8},children:"Something went wrong"}),subTitle:s.jsxs(w,{direction:"vertical",size:"small",children:[s.jsx(je,{type:"secondary",children:"An unexpected error occurred while loading this page."}),s.jsxs(je,{type:"secondary",style:{fontSize:"12px"},children:["Error: ",(null==(e=this.state.error)?void 0:e.message)||"Unknown error"]})]}),extra:s.jsxs(w,{children:[s.jsx(S,{type:"primary",icon:s.jsx(N,{}),onClick:this.handleRetry,children:"Try Again"}),s.jsx(S,{icon:s.jsx(P,{}),onClick:this.handleGoHome,children:"Go Home"})]}),children:!1})}):this.props.children}}const ke=()=>{const{errors:e,clearError:t,clearAllErrors:a}=ae();return r.useEffect(()=>{e.forEach((e,a)=>{z.error({message:"Error Occurred",description:e.message,duration:5e3,key:`error-${a}-${e.timestamp.getTime()}`,icon:s.jsx($,{style:{color:"#ff4d4f"}}),onClose:()=>t(a)})})},[e,t]),0===e.length?null:s.jsx("div",{style:{position:"fixed",top:"70px",right:"20px",zIndex:1e3,maxWidth:"400px"},children:s.jsxs(w,{direction:"vertical",style:{width:"100%"},children:[e.slice(0,3).map((e,a)=>s.jsx(U,{message:"Error",description:s.jsxs("div",{children:[s.jsx("div",{style:{marginBottom:"8px"},children:e.message}),e.code&&s.jsxs("div",{style:{fontSize:"12px",color:"#8c8c8c"},children:["Code: ",e.code]}),s.jsx("div",{style:{fontSize:"12px",color:"#8c8c8c"},children:e.timestamp.toLocaleTimeString()})]}),type:"error",closable:!0,onClose:()=>t(a),action:s.jsx(S,{size:"small",type:"text",icon:s.jsx(Q,{}),onClick:()=>t(a)}),style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)",borderRadius:"6px"}},a)),e.length>3&&s.jsxs(S,{size:"small",type:"link",onClick:a,style:{padding:0},children:["Clear all ",e.length," errors"]})]})})},Re=r.lazy(()=>B(()=>import("./Dashboard-Hi3_WLRf.js"),__vite__mapDeps([0,1,2,3,4,5]))),Ae=r.lazy(()=>B(()=>import("./Studies-D-RyZlaO.js"),__vite__mapDeps([6,1,4,2,5]))),Ce=r.lazy(()=>B(()=>import("./Patients-BWasYxDT.js"),__vite__mapDeps([7,1,4,2,5]))),Ee=r.lazy(()=>B(()=>import("./Sites-DBFOGLwY.js"),__vite__mapDeps([8,1,4,2,5]))),Ie=r.lazy(()=>B(()=>import("./Alerts-D7MC4OK3.js"),__vite__mapDeps([9,1,2,3,4,5]))),qe=r.lazy(()=>B(()=>import("./Agents-CCMaGuDx.js"),__vite__mapDeps([10,1,2,4,5]))),De=r.lazy(()=>B(()=>import("./Conversational-CPKXsNyv.js"),__vite__mapDeps([11,1,2,4,5]))),Te=r.lazy(()=>B(()=>import("./Reports-5gnuz7RH.js"),__vite__mapDeps([12,1,2,4,5]))),{Content:Le}=d;function Oe(){return s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,padding:48},children:s.jsx(M,{size:"large",tip:"Loading page..."})})}function Ne(){he();const[e,t]=r.useState(!1),a=e?80:200,n=ae(e=>e.addError),i=(e,t)=>{n({message:e.message,code:"UI_ERROR",timestamp:new Date,context:"App Component"})};return s.jsx(Se,{onError:i,children:s.jsxs(V,{children:[s.jsxs(d,{style:{minHeight:"100vh"},children:[s.jsx(se,{collapsed:e,onCollapse:t}),s.jsxs(d,{style:{marginLeft:a},children:[s.jsx(ve,{}),s.jsx(Le,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#f0f2f5",overflow:"auto"},children:s.jsx(Se,{onError:i,children:s.jsx(r.Suspense,{fallback:s.jsx(Oe,{}),children:s.jsxs(G,{children:[s.jsx(K,{path:"/",element:s.jsx(J,{to:"/dashboard",replace:!0})}),s.jsx(K,{path:"/dashboard",element:s.jsx(Re,{})}),s.jsx(K,{path:"/studies",element:s.jsx(Ae,{})}),s.jsx(K,{path:"/studies/:studyId",element:s.jsx(Ae,{})}),s.jsx(K,{path:"/patients",element:s.jsx(Ce,{})}),s.jsx(K,{path:"/patients/:patientId",element:s.jsx(Ce,{})}),s.jsx(K,{path:"/sites",element:s.jsx(Ee,{})}),s.jsx(K,{path:"/sites/:siteId",element:s.jsx(Ee,{})}),s.jsx(K,{path:"/alerts",element:s.jsx(Ie,{})}),s.jsx(K,{path:"/agents",element:s.jsx(qe,{})}),s.jsx(K,{path:"/conversational",element:s.jsx(De,{})}),s.jsx(K,{path:"/reports",element:s.jsx(Te,{})})]})})})})]})]}),s.jsx(ke,{})]})})}const Pe=new i({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:3e4}}});Y.createRoot(document.getElementById("root")).render(s.jsx(o.StrictMode,{children:s.jsx(c,{client:Pe,children:s.jsx(F,{theme:{token:{colorPrimary:"#1a365d",colorLink:"#2b6cb0",borderRadius:8,borderRadiusLG:12,borderRadiusSM:4,fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",fontSize:14,colorSuccess:"#2f855a",colorWarning:"#c05621",colorError:"#c53030",colorInfo:"#2b6cb0",colorBgContainer:"#ffffff",colorBgLayout:"#f7fafc"},components:{Card:{borderRadiusLG:12,boxShadowTertiary:"0 1px 3px 0 rgba(0, 0, 0, 0.08), 0 1px 2px 0 rgba(0, 0, 0, 0.04)"},Button:{borderRadius:6},Select:{borderRadius:6},Input:{borderRadius:6}}},children:s.jsx(Se,{children:s.jsx(Ne,{})})})})}));export{ye as a,_e as b,de as c,ue as m,le as p,pe as r,ce as s,ae as u};
